<div class="workflow-canvas" #canvas>
  <div class="canvas-controls">
    <!-- Zoom controls with Bootstrap and Font Awesome -->
    <button class="btn btn-outline-primary" (click)="fitToScreen()" title="Fit to screen">
      <i class="fas fa-expand-arrows-alt"></i>
    </button>
    <button class="btn btn-outline-primary" (click)="zoomIn()" title="Zoom in">
      <i class="fas fa-search-plus"></i>
    </button>
    <button class="btn btn-outline-primary" (click)="zoomOut()" title="Zoom out">
      <i class="fas fa-search-minus"></i>
    </button>
    <button class="btn btn-outline-primary" (click)="centerView()" title="Center view">
      <i class="fas fa-crosshairs"></i>
    </button>
  </div>

  <div class="canvas-content" [style.transform]="transform">
    <svg class="connections-layer">
      <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
        </marker>
      </defs>
      
      <g *ngFor="let connection of connections">
        <path [attr.d]="getConnectionPath(connection)"
              class="connection-line"
              [class.hovered]="false"
              marker-end="url(#arrowhead)" />
      </g>

      <path *ngIf="tempConnection"
            [attr.d]="getTempConnectionPath()"
            class="connection-line temp-connection"
            marker-end="url(#arrowhead)" />
    </svg>

    <div class="nodes-layer">
      <!-- Replace mat-icon-button with standard button -->
      <app-node *ngFor="let node of nodes"
                [node]="node"
                (nodeMove)="onNodeMove($event)"
                (connectionStart)="onConnectionStart($event)"
                (connectionEnd)="onConnectionEnd($event)"
                (connectionCancel)="onConnectionCancel()">
      </app-node>
    </div>

    <div class="add-node-button" *ngIf="nodes.length === 0" (click)="toggleNodePanel()">
      <i class="fas fa-plus"></i>
      <span>Add first step</span>
    </div>
  </div>

  <!-- Replace mat-fab with a standard button (using Font Awesome icon) -->
  <button class="btn btn-primary add-node-fab" (click)="toggleNodePanel()" title="Add Node">
    <i class="fas fa-plus"></i>
  </button>

  <!-- Node Panel Component -->
  <app-node-panel *ngIf="showNodePanel" 
                (close)="showNodePanel = false" 
                [canvasElement]="canvas">
  </app-node-panel>
</div>
